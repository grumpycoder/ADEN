function createAssignmentsGridActionButtons(n,t){var f=t.data.reportId,i=t.data.action,u=t.data.id,e=t.data.isManualUpload,r="";r+=i==="Generate"&&e===!0?'<a class="btn btn-primary btn-grid" data-upload-report href="/uploadreport/'+u+'">Upload<\/a>':'<button class="btn btn-success btn-grid" data-report-id="'+f+'" data-workitem-id="'+u+'" data-workitem-action="'+i+'"><i class="fa fa-spinner fa-spin hidden"><\/i> '+i+"<\/button>&nbsp;";i==="Submit"&&(r+='<a href="/ErrorReport/'+u+'" class="btn btn-danger btn-grid" data-submit-error><i class="fa fa-spinner fa-spin hidden"><\/i> Errors<\/a>&nbsp;');i!=="Generate"&&(r+='<a class="btn btn-default btn-grid" href="/reports/'+t.data.dataYear+"/"+t.data.fileNumber+'">Report<\/a>&nbsp;');n.append(r)}function createGridCancelActionButtons(n,t){var r=t.data.action,u=t.data.id,i="";t.data.canCancel&&(i='<button class="btn btn-default btn-grid" data-cancel-workitem data-cancel-workitem-id="'+u+'"><i class="fa fa-spinner fa-spin hidden"><\/i> Cancel '+r+"<\/button>");n.append(i)}$(function(){console.log("assignments ready");var n=$("#gridCurrentAssignments").dxDataGrid("instance"),t=$("#gridRetrievableAssignments").dxDataGrid("instance");$(document).on("click","[data-workitem-id]",function(i){var r,u,f;i.preventDefault();r=$(this);window.$toggleWorkingButton(r);u=r.data("workitem-id");f="/api/assignment/complete/"+u;$.ajax({url:f,type:"POST",success:function(i){n.refresh();t.refresh();window.$log.success("Completed "+i.action+" assignment")},error:function(n){window.$log.error("Something went wrong: "+n.responseJSON.message)}}).always(function(){window.$toggleWorkingButton(r)})});$(document).on("click","button[data-cancel-workitem]",function(i){var r,u,f;i.preventDefault();r=$(this);window.$toggleWorkingButton(r);u=r.data("cancel-workitem-id");f="/api/assignment/cancel/"+u;$.ajax({url:f,type:"POST",success:function(i){n.refresh().done(function(){});t.refresh().done(function(){});window.$log.success("Cancelled "+i.action+" assignment")},error:function(n){window.$log.error("Something went wrong: "+n.responseJSON.message)}}).always(function(){window.$toggleWorkingButton(r)})});$(document).on("click","[data-upload-report]",function(i){i.preventDefault();console.log("upload report");var r=$(this).attr("href"),u="Upload Report";$.ajax({url:r,type:"GET",success:function(i){window.showBSModal({title:u,body:i,size:"large",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Submit",cssClass:"btn-primary",onClick:function(i){var e=$("#Id").val(),o="/api/assignment/submitreport/"+e,f=new FormData,s=$("#files").get(0),u=s.files,r;for(window.$showModalWorking(),r=0;r<u.length;r++)f.append(u[r].name,u[r]);$.ajax({type:"POST",url:o,data:f,dataType:"json",contentType:!1,processData:!1,success:function(){n.refresh();t.refresh();window.$log.success("Submitted report")},error:function(n){window.$log.error("Error: "+n.resonseJson.message)},complete:function(){$(".modalContainer").html("");$(".modal").modal("hide");$(i.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();window.$hideModalWorking()}})}}]})},error:function(){window.$log.error("Error showing report upload")}})});$(document).on("click","[data-submit-error]",function(i){i.preventDefault();var r=$(this).attr("href"),u="Submission Error";$.ajax({url:r,type:"GET",success:function(i){window.showBSModal({title:u,body:i,size:"large",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Submit",cssClass:"btn-primary",onClick:function(){var f=$("#Id").val(),i,r,u;if(window.$showModalWorking(),i=new FormData,i.append("Id",f),i.append("Note",$("#note").val()),r=document.getElementById("files").files,r.length>0)for(u=0;u<r.length;u++)i.append("files",r[u]);$.ajax({type:"POST",url:"/assignment/submiterror/",data:i,contentType:!1,processData:!1,success:function(){n.refresh();t.refresh();window.$log.success("Submitted report")},error:function(n){window.$log.error("Error: "+n.statusText)},complete:function(){$(".modalContainer").html("");$(".modal").modal("hide");window.$hideModalWorking()}})}}]})},error:function(){window.$log.error("Error showing history")}})})});