function createAssignmentsGridActionButtons(n,t){var u=t.data.reportId,f=t.data.canGenerate,e=t.data.canReject,o=t.data.canSubmit,s=t.data.canReviewError,h=t.data.action,c=t.data.actionName,a=t.data.actionDescription,r=t.data.id,l=t.data.isManualUpload,i="";i+=f&&l===!0?'<a class="btn btn-primary btn-sm btn-grid" data-upload-report href="/uploadreport/'+r+'">Upload<\/a>':'<button class="btn btn-success btn-sm btn-grid" data-report-id="'+u+'" data-workitem-id="'+r+'" data-workitem-action="'+h+'"><i class="fa fa-spinner fa-spin hidden"><\/i> '+c+"<\/button>";e&&(i+='<button class="btn btn-danger btn-sm btn-grid" data-report-id="'+u+'" data-workitem-id="'+r+'" data-workitem-action="reject"><i class="fa fa-spinner fa-spin hidden"><\/i>Reject<\/button>');o&&(i+='<button class="btn btn-danger btn-sm btn-grid" data-submit-error data-workitem-id='+r+'><i class="fa fa-spinner fa-spin hidden"><\/i> Report Errors<\/button>');s&&(i+='<button class="btn btn-primary btn-sm btn-grid" data-image-viewer href="/workitemimages/'+r+'">View Details<\/button>');f||(i+='<a class="btn btn-default btn-sm btn-grid" href="/files/'+t.data.dataYear+"/"+t.data.fileNumber+'">Review File<\/a>');n.append(i)}function createGridCancelActionButtons(n,t){var r=t.data.id,u=t.data.canCancel,i="";u&&(i='<button class="btn btn-default btn-grid" data-cancel-workitem data-cancel-workitem-id="'+r+'"><i class="fa fa-spinner fa-spin hidden"><\/i> Cancel<\/button>');n.append(i)}$(function(){console.log("assignments ready");var n=$("#gridCurrentAssignments").dxDataGrid("instance"),t=$("#gridRetrievableAssignments").dxDataGrid("instance");$(document).on("click","[data-workitem-action]",function(i){var r;i.preventDefault();r=$(this);window.$toggleWorkingButton(r);var u=r.data("workitem-id"),e=r.data("workitem-action"),f="/api/assignment/complete/"+u;e==="reject"&&(f="/api/assignment/reject/"+u);$.ajax({url:f,type:"POST",success:function(i){n.refresh();t.refresh();window.$log.success("Completed "+i.action+" assignment")},error:function(n){window.$log.error("Something went wrong: "+n.responseJSON.message)}}).always(function(){window.$toggleWorkingButton(r)})});$(document).on("click","button[data-cancel-workitem]",function(i){var r,u,f;i.preventDefault();r=$(this);window.$toggleWorkingButton(r);u=r.data("cancel-workitem-id");f="/api/assignment/cancel/"+u;$.ajax({url:f,type:"POST",success:function(i){n.refresh().done(function(){});t.refresh().done(function(){});window.$log.success("Cancelled "+i.action+" assignment")},error:function(n){window.$log.error("Something went wrong: "+n.responseJSON.message)}}).always(function(){window.$toggleWorkingButton(r)})});$(document).on("click","[data-upload-report]",function(i){i.preventDefault();console.log("upload report");var r=$(this).attr("href"),u="Upload Report";$.ajax({url:r,type:"GET",success:function(i){window.showBSModal({title:u,body:i,size:"large",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Submit",cssClass:"btn-primary",onClick:function(i){var e=$("#Id").val(),o="/api/assignment/submitreport/"+e,f=new FormData,s=$("#files").get(0),u=s.files,r;for(window.$showModalWorking(),r=0;r<u.length;r++)f.append(u[r].name,u[r]);$.ajax({type:"POST",url:o,data:f,dataType:"json",contentType:!1,processData:!1,success:function(){n.refresh();t.refresh();window.$log.success("Submitted report")},error:function(n){window.$log.error("Error: "+n.resonseJson.message)},complete:function(){$(".modalContainer").html("");$(".modal").modal("hide");$(i.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();window.$hideModalWorking()}})}}]})},error:function(){window.$log.error("Error showing report upload")}})});$(document).on("click","[data-submit-error]",function(i){i.preventDefault();var r=$(this).data("workitem-id"),u="/ErrorReport/"+r,f="/assignment/submiterror/",e="Submission Error";$.ajax({url:u,type:"GET",success:function(i){window.showBSModal({title:e,body:i,size:"large",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Submit",cssClass:"btn-primary",onClick:function(){var i,u,e;if(window.$showModalWorking(),i=new FormData,i.append("Id",r),i.append("Description",$("#description").val()),u=document.getElementById("files").files,u.length>0)for(e=0;e<u.length;e++)i.append("files",u[e]);console.log("id",r);$.ajax({type:"POST",url:f,data:i,contentType:!1,processData:!1,success:function(){n.refresh();t.refresh();window.$log.success("Submitted report")},error:function(n){window.$log.error("Error: "+n.statusText)},complete:function(){$(".modalContainer").html("");$(".modal").modal("hide");window.$hideModalWorking()}})}}]})},error:function(){window.$log.error("Error showing history")}})});$(document).on("click","[data-image-viewer]",function(n){n.preventDefault();var i=$(this),t=$(this).attr("href");window.BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Work Item Images",message:$("<div><\/div>").load(t),buttons:[{label:"Close",action:function(n){n.close()}}]})})});