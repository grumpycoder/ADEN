function createSubmissionGridActionButtons(n,t){var i="",u=t.data.canCancel,f=t.data.canStart,e=t.data.canReopen,o=t.data.canWaiver,s=t.data.canReview,h=t.data.startDisabled,c=t.data.reopenDisabled,r=t.data.id,l=t.data.fileNumber,a=t.data.dataYear;s&&(i+='<a class="btn btn-success btn-sm btn-grid" href="/reports/'+a+"/"+l+'">Review File<\/a>&nbsp;');u&&(i+='<a href="#" class="btn btn-default btn-sm btn-grid" data-cancel data-submission-id='+r+'><i class="fa fa-spinner fa-spin hidden"><\/i> Cancel<\/a>&nbsp;');e&&(i+='<a href="/audit/'+r+'" class="btn btn-default btn-sm btn-grid" data-reopen data-title="ReOpen Reason" data-submission-id='+r,c&&(i+=' disabled data-toggle="tooltip" data-placement="left" title="Missing group assignments or report action"'),i+='><i class="fa fa-spinner fa-spin hidden"><\/i> ReOpen<\/a>&nbsp;');f&&(i+='<a href="#" class="btn btn-default btn-sm btn-grid" data-start data-submission-id='+r,h&&(i+=' disabled data-toggle="tooltip" data-placement="left" title="Missing group assignments or report action"'),i+='><i class="fa fa-spinner fa-spin hidden"><\/i> Start<\/a>&nbsp;');o&&(i+='<a href="/audit/'+r+'" class="btn btn-default btn-sm btn-grid" data-waiver data-title="Waiver Reason" data-submission-id='+r+'><i class="fa fa-spinner fa-spin hidden"><\/i> Waiver<\/a>&nbsp;');n.append(i)}function rowStyle(n,t){var i=["active","success","info","warning","danger"],r=window.moment();return n==="Completed"||n==="Waived"?i[1]:n==="CompleteWithErrors"?i[2]:n!=="Completed"&&r.isSameOrAfter(t)?i[4]:n!=="Completed"&&r.add(14,"days").isSameOrAfter(t)?i[3]:""}function rowPrepared(n){if(n.rowType==="data"){var t=rowStyle(n.data.submissionStateDisplay,n.data.dueDate);n.rowElement.addClass(t)}}$(function(){console.log("submission ready");var n=$("#grid").dxDataGrid("instance");$(document).on("click","[data-waiver]",function(t){t.preventDefault();var i=$(this),r=i.data("submission-id"),u=i.data("title"),f=$(this).attr("href"),e="/api/submission/waiver/"+r;$.ajax({url:f,type:"GET",success:function(t){window.showBSModal({title:u,body:t,size:"large",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Submit",cssClass:"btn-primary",onClick:function(t){window.$showModalWorking();$.ajax({type:"POST",url:e,data:$("form").serialize(),dataType:"json",success:function(){n.refresh().done(function(n){console.log("done",n)});window.$log.success("Waived submission")},error:function(n){window.$log.error("Error: "+n.responseJSON.message)},complete:function(){$(".modalContainer").html("");$(".modal").modal("hide");$(t.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();window.$hideModalWorking()}})}}]})},error:function(){window.$log.error("Error showing audit entry")}})});$(document).on("click","[data-start]",function(t){var i,r;t.preventDefault();i=$(this);window.$toggleWorkingButton(i);r=i.data("submission-id");$.ajax({url:"/api/submission/start/"+r,type:"POST"}).done(function(){n.refresh().done(function(n){console.log("done",n)});window.$log.success("Created assignment")}).fail(function(n){window.$log.error("Something went wrong: "+n.responseJSON.message)}).always(function(){window.$toggleWorkingButton(i,"off")})});$(document).on("click","[data-reopen]",function(t){t.preventDefault();var i=$(this),r=i.data("title"),u=i.data("submission-id"),f=$(this).attr("href"),e="/api/submission/reopen/"+u;$.ajax({url:f,type:"GET",success:function(t){window.showBSModal({title:r,body:t,size:"large",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Submit",cssClass:"btn-primary",onClick:function(t){window.$showModalWorking();$.ajax({type:"POST",url:e,data:$("form").serialize(),dataType:"json",success:function(){n.refresh().done(function(n){console.log("done",n)});window.$log.success("ReOpened submission")},error:function(n){console.log("error",n);window.$log.error("Error: "+n.responseJSON.message)},complete:function(){$(".modalContainer").html("");$(".modal").modal("hide");$(t.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();window.$hideModalWorking()}})}}]})},error:function(){window.$log.error("Error showing audit entry")}})});$(document).on("click","[data-cancel]",function(t){var i,r;t.preventDefault();i=$(this);window.$toggleWorkingButton(i);r=i.data("submission-id");$.ajax({url:"/api/submission/cancel/"+r,type:"POST"}).done(function(){n.refresh().done(function(n){console.log("done",n)});window.$log.success("Cancelled assignments")}).fail(function(n){window.$log.error("Something went wrong: "+n.responseJSON.message)}).always(function(){window.$toggleWorkingButton(i,"off")})});$(document).on("click","[data-history]",function(n){n.preventDefault();var t=$(this).attr("href"),i=$(this).data("title");console.log("url",t);window.BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:i,message:$("<div><\/div>").load(t,function(n,t){t==="error"&&window.$log.error("Error showing history")}),buttons:[{label:"Close",action:function(n){n.close()}}]})});$(document).on("click","[data-reassign]",function(n){n.preventDefault();var t=$(this).data("workitem-id"),i=$(this).attr("href")+"/"+t;$.ajax({url:i,type:"POST",success:function(n){window.showBSModal({title:"Reassign Task",body:n,size:"lg",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Save",cssClass:"btn-primary",onClick:function(n){window.$showModalWorking();var t=$("form").serialize();$.ajax({type:"POST",url:"/api/assignment/reassign",data:model=t}).done(function(){window.$log.success("Reassigned task")}).fail(function(){window.$log.error("Failed to reassign task. "+error)}).always(function(){$(".modalContainer").html("");$(".modal").modal("hide");$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();window.$hideModalWorking()})}}]})},error:function(){window.$log.error("Error showing reassignment")}})});$(document).on("click","[data-image-viewer]",function(n){n.preventDefault();var t=$(this),i=t.data("workitem-id"),r="/workitemimages/"+i;window.BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Work Item Images",message:$("<div><\/div>").load(r),buttons:[{label:"Close",action:function(n){n.close()}}]})});$('[data-toggle="tooltip"]').tooltip()});