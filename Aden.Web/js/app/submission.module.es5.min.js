"use strict";function createSubmissionGridActionButtons(n,t){var i="",u=t.data.submissionStateId,e=t.data.canStartReport,f=t.data.hasAdmin,r=t.data.id,o=t.data.fileNumber,s=t.data.dataYear;console.log("data",t.data);u!==1&&(i='<a class="btn btn-default btn-sm btn-grid" href="/reports/'+s+"/"+o+'">Reports<\/a>&nbsp;');u>=5&&f&&(i+='<button class="btn btn-default btn-sm btn-grid" data-start data-submission-id='+r+'><i class="fa fa-spinner fa-spin hidden"><\/i> ReOpen<\/button>');u===1&&f&&(i+=e?'<button class="btn btn-default btn-sm btn-grid" data-start data-submission-id='+r+'><i class="fa fa-spinner fa-spin hidden"><\/i> Start<\/button>&nbsp;':'<button class="btn btn-default btn-sm btn-grid" data-start data-submission-id='+r+' disabled="true" data-toggle="tooltip" data-title="Missing action on specification" title="Missing action on specification" data-placement="left"><i class="fa fa-spinner fa-spin hidden"><\/i> Start<\/button>&nbsp;',i+='<button class="btn btn-default btn-sm btn-grid" data-waiver data-submission-id='+r+'><i class="fa fa-spinner fa-spin hidden"><\/i> Waiver<\/button>');n.append(i)}function rowStyle(n,t){var i=["active","success","info","warning","danger"],r=window.moment();return n==="Completed"||n==="Waived"?i[1]:n==="CompleteWithErrors"?(console.log("complete with errors"),i[2]):n!=="Completed"&&r.isSameOrAfter(t)?i[4]:n!=="Completed"&&r.add(14,"days").isSameOrAfter(t)?i[3]:""}function rowPrepared(n){if(n.rowType==="data"){var t=rowStyle(n.data.submissionStateKey,n.data.dueDate);n.rowElement.addClass(t)}}$(function(){console.log("submission ready");var n=$("#grid").dxDataGrid("instance");$(document).on("click","[data-waiver]",function(t){t.preventDefault();var i=$(this),r=i.data("submission-id");window.$toggleWorkingButton(i);$.ajax({url:"/api/report/waiver/"+r,type:"POST"}).done(function(t){n.refresh().done(function(){});$log.success("Waived"+t.fileNumber+" - "+t.fileName)}).fail(function(n){console.log("err",n);window.$log.error("Something went wrong: "+n.responseJSON.message)}).always(function(){window.$toggleWorkingButton(i,"off")})});$(document).on("click","[data-start]",function(t){t.preventDefault();var i=$(this),r=i.data("submission-id");window.$toggleWorkingButton(i);$.ajax({url:"/api/report/create/"+r,type:"POST"}).done(function(){n.refresh().done(function(n){console.log("done",n)});window.$log.success("Created assignment")}).fail(function(n){console.log("err",n);window.$log.error("Something went wrong: "+n.responseJSON.message)}).always(function(){window.$toggleWorkingButton(i,"off")})});$(document).on("click","[data-history]",function(n){n.preventDefault();var t=$(this).attr("href"),i=$(this).data("title");$.ajax({url:t,type:"POST",success:function(n){window.showBSModal({title:i,body:n,size:"large"})},error:function(n){console.log("err",n);window.$log.error("Error showing history")}})});$(document).on("click","[data-reassign]",function(n){n.preventDefault();var t=$(this).data("workitem-id"),i=$(this).attr("href")+"/"+t;$.ajax({url:i,type:"POST",success:function(n){window.showBSModal({title:"Reassign Task",body:n,size:"lg",actions:[{label:"Cancel",cssClass:"btn-default",onClick:function(n){console.log("e",n);$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}},{label:"Save",cssClass:"btn-primary",onClick:function(n){window.$showModalWorking();var t=$("form").serialize();$.ajax({type:"POST",url:"/api/assignment/reassign",data:model=t}).done(function(){window.$log.success("Reassigned task")}).fail(function(){window.$log.error("Failed to reassign task. "+error)}).always(function(){$(".modalContainer").html("");$(".modal").modal("hide");$(n.target).parents(".modal").modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove();window.$hideModalWorking()})}}]})},error:function(n){console.log("err",n);window.$log.error("Error showing reassignment")}})})});